import{_ as i,c as a,o as t,aA as n}from"./chunks/framework.Gq9Ydw09.js";const E=JSON.parse('{"title":"Getting Started","description":"","frontmatter":{},"headers":[],"relativePath":"getting_started.md","filePath":"getting_started.md","lastUpdated":null}'),e={name:"getting_started.md"};function l(h,s,p,k,r,d){return t(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="Getting-Started" tabindex="-1">Getting Started <a class="header-anchor" href="#Getting-Started" aria-label="Permalink to &quot;Getting Started {#Getting-Started}&quot;">​</a></h1><h2 id="Quick-Example:-PPO-on-CartPole" tabindex="-1">Quick Example: PPO on CartPole <a class="header-anchor" href="#Quick-Example:-PPO-on-CartPole" aria-label="Permalink to &quot;Quick Example: PPO on CartPole {#Quick-Example:-PPO-on-CartPole}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DRiL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Zygote  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Required for automatic differentiation</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ClassicControlEnvironments</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create parallel environments</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BroadcastedParallelEnv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CartPoleEnv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Actor-Critic network</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ActorCriticLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">observation_space</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">action_space</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Algorithm with default hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ppo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PPO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create agent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">agent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Agent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, ppo; verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Train for 100k steps</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">learn_stats, timer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> train!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(agent, env, ppo, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100_000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Extract deployment policy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(agent)</span></span></code></pre></div><h2 id="Quick-Example:-SAC-on-Continuous-Control" tabindex="-1">Quick Example: SAC on Continuous Control <a class="header-anchor" href="#Quick-Example:-SAC-on-Continuous-Control" aria-label="Permalink to &quot;Quick Example: SAC on Continuous Control {#Quick-Example:-SAC-on-Continuous-Control}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DRiL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Zygote  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Required for automatic differentiation</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Continuous action environment</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BroadcastedParallelEnv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">YourContinuousEnv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SAC-specific policy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SACPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">observation_space</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">action_space</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SAC algorithm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sac </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SAC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(learning_rate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3f-4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, buffer_capacity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1_000_000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create agent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">agent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Agent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, sac; verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Train</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">agent, buffer, stats, timer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> train!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(agent, env, sac, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500_000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="Key-Hyperparameters" tabindex="-1">Key Hyperparameters <a class="header-anchor" href="#Key-Hyperparameters" aria-label="Permalink to &quot;Key Hyperparameters {#Key-Hyperparameters}&quot;">​</a></h2><h3 id="PPO" tabindex="-1">PPO <a class="header-anchor" href="#PPO" aria-label="Permalink to &quot;PPO {#PPO}&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:right;">Parameter</th><th style="text-align:right;">Default</th><th style="text-align:right;">Description</th></tr></thead><tbody><tr><td style="text-align:right;"><code>gamma</code></td><td style="text-align:right;">0.99</td><td style="text-align:right;">Discount factor</td></tr><tr><td style="text-align:right;"><code>gae_lambda</code></td><td style="text-align:right;">0.95</td><td style="text-align:right;">GAE lambda</td></tr><tr><td style="text-align:right;"><code>clip_range</code></td><td style="text-align:right;">0.2</td><td style="text-align:right;">PPO clipping range</td></tr><tr><td style="text-align:right;"><code>ent_coef</code></td><td style="text-align:right;">0.0</td><td style="text-align:right;">Entropy coefficient</td></tr><tr><td style="text-align:right;"><code>n_steps</code></td><td style="text-align:right;">2048</td><td style="text-align:right;">Steps per rollout</td></tr><tr><td style="text-align:right;"><code>batch_size</code></td><td style="text-align:right;">64</td><td style="text-align:right;">Minibatch size</td></tr><tr><td style="text-align:right;"><code>epochs</code></td><td style="text-align:right;">10</td><td style="text-align:right;">Epochs per update</td></tr></tbody></table><h3 id="SAC" tabindex="-1">SAC <a class="header-anchor" href="#SAC" aria-label="Permalink to &quot;SAC {#SAC}&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:right;">Parameter</th><th style="text-align:right;">Default</th><th style="text-align:right;">Description</th></tr></thead><tbody><tr><td style="text-align:right;"><code>gamma</code></td><td style="text-align:right;">0.99</td><td style="text-align:right;">Discount factor</td></tr><tr><td style="text-align:right;"><code>tau</code></td><td style="text-align:right;">0.005</td><td style="text-align:right;">Soft update rate</td></tr><tr><td style="text-align:right;"><code>buffer_capacity</code></td><td style="text-align:right;">1M</td><td style="text-align:right;">Replay buffer size</td></tr><tr><td style="text-align:right;"><code>batch_size</code></td><td style="text-align:right;">256</td><td style="text-align:right;">Batch size</td></tr><tr><td style="text-align:right;"><code>train_freq</code></td><td style="text-align:right;">1</td><td style="text-align:right;">Steps between updates</td></tr></tbody></table><h2 id="Evaluation" tabindex="-1">Evaluation <a class="header-anchor" href="#Evaluation" aria-label="Permalink to &quot;Evaluation {#Evaluation}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">eval_env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartPoleEnv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(max_steps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stats </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> evaluate_agent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(agent, eval_env; n_episodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, deterministic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mean return: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(mean(stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">episodic_returns))</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="Deployment" tabindex="-1">Deployment <a class="header-anchor" href="#Deployment" aria-label="Permalink to &quot;Deployment {#Deployment}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Extract lightweight policy (actor only)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(agent)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Get actions for observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">actions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(policy, observations; deterministic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,14)])])}const o=i(e,[["render",l]]);export{E as __pageData,o as default};
